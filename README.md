# 某医院门诊预约挂号系统(以宁波市第二医院为例)

## 需求分析：

某人民医院的规模日渐扩大，需要开发一个在线门诊预约挂号系统。该系统采用B/S结构，在首页就列出了预约挂号的时间（**从当天起往后两周**）和医院所有的科室，游客不需要登录就可以根据筛选条件找到对应的医生列表，不需要登录系统，如图1所示。每个医生除了要显示姓名、职称（主治医师、副主任医师、主任医师）、预约日期、诊金、当前已预约数和一共预约数等，最好还能显示该医生门诊的位置，比如2号楼301办公室。**需要注意的是，医生的名气和职称越高，诊金也越高**。

点击医生的姓名，可以查看医生的简介，其中包含了他擅长治疗的疾病。另外还有该医生未来两周的排班情况，点击有班的日期直接可以预约。

如果想要进行预约，就必须登录系统，登录时可以不实现图片验证。如果还没有账号，就需要先注册。注册时至少要填写用户名、姓名、身份证号、医保卡号等信息，本设计可以不实现手机短信验证码。系统应当能够判断用户名是否重复，以及身份证号是否合法，并能够从身份证号里识别出生日和性别信息（提示：倒数第二位可以推断出性别）。

每个医生的预约列表中显示：上午是从8点到11点，下午从13点30到16点30，每隔3分钟一个班，如果已被预约，则显示灰色，否则显示白色。预约完成后，可以不进行支付，但是必须要有个确认页面，尽可能避免用户误操作。

此外，该系统应该有个后台管理模块，可以有专门的管理员对医生信息进行增加、删除和修改操作，不需要对科室信息进行操作。另外，管理员还能够对医生进行排班，并且还能根据日期查看该医生的被预约记录，每条记录中包含了病人的详细信息。

## 项目概述

本项目是一个基于前后端分离架构的 Web 应用系统，旨在通过合理的技术选型与架构设计，实现高效、安全、易维护的业务功能。本 README 文档旨在为 HR 提供一个快速了解项目全貌的指南，重点突出技术实现细节与架构设计思路，避免夸大其词，确保信息的真实性与准确性。

## 技术栈

### 后端技术栈

- **Spring Boot**：作为后端开发的主框架，Spring Boot 提供了快速构建生产级应用的便利，集成了大量常用的第三方库，简化了配置过程，提高了开发效率。
- **Maven**：通过 Maven 进行项目构建与依赖管理，实现了多模块开发与统一依赖版本控制，极大地简化了项目的构建与维护流程。
- **MyBatis**：用于数据库操作，通过 XML 或注解方式映射 SQL 语句，使得数据库操作更加灵活且易于维护。
- **阿里云 OSS 服务**：用于存储项目中的文件资源，如用户上传的图片、文档等，提供了高可用、高扩展的存储解决方案。
- **阿里云验证码 2.0**：增强了系统的安全验证机制，有效防止暴力破解、恶意注册等安全威胁。

### 前端技术栈

- **Vue 3**：作为前端开发的主框架，Vue 3 提供了更快的渲染速度、更好的 TypeScript 支持以及更灵活的组合式 API，使得前端开发更加高效与灵活。
- **Element Plus**：基于 Vue 3 的组件库，提供了丰富的 UI 组件与样式，简化了前端页面的开发过程，提升了用户体验。
- **AI 辅助开发**：在页面样式开发过程中，利用 AI 技术辅助进行样式设计，提高了开发效率与页面美观度。
- **Vue Router**：用于实现前端路由管理，实现了单页面应用（SPA）的页面跳转与状态保持。
- **Pinia**：作为 Vue 的状态管理库，替代了传统的 Vuex，提供了更简洁的 API 。
- **Axios**：用于前端与后端的数据交互，支持 Promise API，简化了异步请求的处理过程。

## 项目架构设计

### 后端架构

后端系统根据功能划分为多个模块，实现了代码的解耦与复用：

- **common 模块**：主要存储工具类、异常处理类、统一返回结果类、配置类以及常量类等，为整个项目提供基础支持。
- **pojo 模块**：细分成 entity 实体类、vo（数据展示层）与 dto（数据通信层），实现了数据的分层管理，提高了代码的可读性与可维护性。
- **server 模块**：为主服务层，存储了 controller、service、mapper 层以及注解、切面、过滤器、处理器、拦截器、定时任务、配置类等，实现了业务逻辑的处理与数据的持久化。

### 日志记录

配置了自定义的 log 注解，通过 AOP 切面类的方式，记录管理员的敏感操作。具体记录了方法名、类名、参数以及返回结果，并通过 mapper 层直接存储到数据库中。同时，仅提供了日志的查询操作，确保了日志数据的安全性。

### 安全机制

- **数据加密传输**：前后端在涉及非 GET 请求时，对数据进行加密传输。前端使用 AES 加密 JSON 数据，再使用服务器 RSA 公钥加密 AES 秘钥，并生成前端自己的密钥对，对加密后的数据加上时间戳进行签名，一同传递给后端进行验证。后端则先对签名进行验签，然后再通过过滤器进行数据的解密，替换 body 主体，实现业务层的无感知。
- **密钥管理**：前端将服务器公钥存储在 sessionStorage 中，自己的密钥对则存储在内存中，随着用户退出和浏览器关闭清除。后端则将密钥存储在数据库和 Redis 中，优先从 Redis 中读取，利用定时任务进行轮换，确保了密钥的安全性。

### 前端架构

前端项目分为用户端和管理端，通过不同的请求前缀（/user 和 /admin）进行区分。

- **用户信息管理**：将用户信息存储在 Pinia 的 store 中，用于验证用户是否登录，实现了用户状态的持久化与状态共享。
- **页面布局与样式**：利用 Element Plus 组件库与 AI 辅助开发技术，实现了美观且响应式的页面布局与样式设计。

## 总结

本项目通过合理的技术选型与架构设计，实现了高效、安全、易维护的业务功能。后端采用 Spring Boot + MyBatis + Maven 的技术栈，前端采用 Vue 3 + Element Plus + AI 辅助开发的技术栈，通过前后端分离的方式，实现了前后端的独立开发与部署。同时，通过引入数据加密传输、密钥管理等安全机制，确保了系统的安全性。